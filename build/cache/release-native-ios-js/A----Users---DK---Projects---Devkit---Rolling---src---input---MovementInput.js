6480b77a84063b46f76ddf291f6fa8d6
jsio("import device");jsio("import ui.View as View");jsio("import src.entity.Square as Square");var Users_DK_Projects_Devkit_Rolling_src_input_MovementInput=__class__;
exports=Users_DK_Projects_Devkit_Rolling_src_input_MovementInput(function(){return this.init&&this.init.apply(this,arguments)},View,function(f){this.init=function(b,c,a,d,e,g){f(this,"init",[g]);this.updateOpts({x:b,y:c,width:a,height:d});this.enabled=e;this.showDirection=!0;this.setup();this.setupEvents()};this.tick=function(){if(this.showDirection&&this.squares&&this.state!==this.prevState){for(var b=0;8>b;++b)this.squares[b].updateOpts({backgroundColor:"#5FFFFF"});this.state!==this.states.neutral&&
this.squares[this.state].updateOpts({backgroundColor:"#FF0000"})}};this.setup=function(){this.states={up:0,upRight:1,right:2,downRight:3,down:4,downLeft:5,left:6,upLeft:7,neutral:8};this.state=this.states.neutral;this.prevState=null;if(this.showDirection){var b=device.width/2,c=device.height/2;this.squares=[];for(var a=0;8>a;++a)this.squares.push(new Square(100*Math.sin(45*a*(Math.PI/180))+b,100*Math.cos((45*a+180)*(Math.PI/180))+c,50,50,"#5FFFFF")),this.addSubview(this.squares[a])}};this.setupEvents=
function(){this.on("InputStart",bind(this,function(b){this.startDrag({inputStartEvt:b,radius:10})}));this.on("DragStart",bind(this,function(){}));this.on("Drag",bind(this,function(b,c){var a=c.srcPt.x-b.srcPt.x,d=c.srcPt.y-b.srcPt.y,e=Math.sqrt(a*a+d*d),a=Math.atan2(d,a);this.state=50>e?this.states.neutral:a<7*-Math.PI/8||a>7*Math.PI/8?this.states.left:a<5*-Math.PI/8?this.states.upLeft:a<3*-Math.PI/8?this.states.up:a<-Math.PI/8?this.states.upRight:a>5*Math.PI/8?this.states.downLeft:a>3*Math.PI/8?
this.states.down:a>Math.PI/8?this.states.downRight:this.states.right}));this.on("DragStop",bind(this,function(){this.state=this.states.neutral}))};this.setEnable=function(b){this.enabled=b}});
